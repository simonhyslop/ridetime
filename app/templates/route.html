{% extends 'base.html' %}

{% block content %}

    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{{ url_for('saved') }}">Saved Routes</a></li>
        <li class="breadcrumb-item active" aria-current="page">{{ route.title }}</li>
    </ol>

    <div class="container">
        <h1>
            {{ route.title|routetitle }}
            <button type="button" class="btn btn-secondary btn-sm" data-toggle="modal"
                    data-target="#editRoute">Edit
            </button>

            <button type="button" class="btn btn-primary float-right" onclick="getGPX()">Download GPX
            </button>
        </h1>

        <p>Created {{ route.timestamp|timeago }}</p>

        <table class="table">
            {% include '_routedisplay.html' %}
        </table>
    </div>

    {% include '_mapbox.html' %}

    {% include '_editmodal.html' %}


    <script>
        function updateRoute() {
            $.post('/editroute/{{ route.id }}', {
                title: $(editRouteTitle).val(),
            }).done(function() {
                window.location = '{{ url_for('saved_route', route_id=route.id) }}';
            });
        }

        function resetModal() {
            let title = document.getElementById('editRouteTitle');
            title.value = "{{ route.title }}";
        }

        function getGPX() {
            window.location = '{{ url_for('download_gpx', route_id=route.id) }}';
        }

    </script>

{% endblock %}